# Golang实现内存缓存系统

## SetMaxMemory

- 判断当前内存是否超过了最大内存大小
- SetMaxMemory要求支持多种单位的表示（1KB 100KB 1MB 2MB 1GB 最大单位为GB），需要对输入的内存大小做一个转换，实现一个 parseSize 函数去解析用户的输入，如果用户输入的单位不合法，就设为默认值 100MB
- SetMaxMemory主体更改结构体相应字段并打印结果即可

## Set

- expire为可选参数，默认值为
- 将键值对存入我们的缓存系统中
- 使用map实现，设计value结构体
- map并发不安全，进行并发设计
- 重复 Set 一个已存在值的情况
- 判断是否超过内存

## Get

- 加读锁保护

- 先通过 get 方法拿到对应的值
- 如果存在该键，且该值没有过期或者没有过期时间，则返回该值
- 否则返回 nil，并删除该过期键

## Del

- 加写锁保护

- 直接调用 del 函数进行删除对应键值对即可

## Exist

- 加读锁保护

- 直接获取对应键值对，以此判断是否存在该键

## Flush

- Flush 方法，是在整个缓存系统的缓存数据不需要使用之后，用来清空所有的缓存时使用的。这里我们利用 Go 语言的垃圾回收机制，直接将整个 map 置空，Go 语言的垃圾回收机制会直接将没有使用的内存进行回收

- 加写锁保护
- 将整个 map 置空，并将当前使用内存大小清空

## Keys

- 加读锁保护

- 利用 len() 函数直接获取

## 轮询检查删除过期键

采用 time.NewTicker，定义一个制定周期的定时器
由于需要不断轮询，故需要放在 for 循环中
配合 select 实现一个阻塞式的轮询检查并删除过期键的操作

## 单元测试



